<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="the needI a SharePoint tool to report critical incidents that occur in programs across the agency. A critical incident happens, a user fills out the InfoPath form, a SharePoint workflow routes the in">
<meta name="keywords" content="SharePoint,Highcharts">
<meta property="og:type" content="article">
<meta property="og:title" content="Connecting a Highcharts Graph to a SharePoint List">
<meta property="og:url" content="http://rooksblog.com/2019/11/15/List/index.html">
<meta property="og:site_name" content="Rooks Blog">
<meta property="og:description" content="the needI a SharePoint tool to report critical incidents that occur in programs across the agency. A critical incident happens, a user fills out the InfoPath form, a SharePoint workflow routes the in">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://rooksblog.com/images/giphyLynch.gif">
<meta property="og:image" content="http://rooksblog.com/images/highchartsSP/excelIncidents.PNG">
<meta property="og:image" content="http://rooksblog.com/images/highchartsSP/fiscalGif.gif">
<meta property="og:updated_time" content="2019-11-15T22:20:02.612Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Connecting a Highcharts Graph to a SharePoint List">
<meta name="twitter:description" content="the needI a SharePoint tool to report critical incidents that occur in programs across the agency. A critical incident happens, a user fills out the InfoPath form, a SharePoint workflow routes the in">
<meta name="twitter:image" content="http://rooksblog.com/images/giphyLynch.gif">
    
    
        
          
              <link rel="shortcut icon" href="/images/pip-head2.png">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/pip-head2.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/pip-eight.png">
          
        
    
    <!-- title -->
    <title>Connecting a Highcharts Graph to a SharePoint List</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2017/05/15/Adding-Query-Params-to-a-WordPress-Site/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://rooksblog.com/2019/11/15/List/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://rooksblog.com/2019/11/15/List/&text=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rooksblog.com/2019/11/15/List/&is_video=false&description=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Connecting a Highcharts Graph to a SharePoint List&body=Check out this article: http://rooksblog.com/2019/11/15/List/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://rooksblog.com/2019/11/15/List/&name=Connecting a Highcharts Graph to a SharePoint List&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-need"><span class="toc-number">1.</span> <span class="toc-text">the need</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-implementation"><span class="toc-number">2.</span> <span class="toc-text">the implementation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-end-result"><span class="toc-number">3.</span> <span class="toc-text">the end result</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Connecting a Highcharts Graph to a SharePoint List
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Rooks Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-11-15T16:32:58.000Z" itemprop="datePublished">2019 Nov 15</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Highcharts/">Highcharts</a>, <a class="tag-link" href="/tags/SharePoint/">SharePoint</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="/images/giphyLynch.gif" alt="Giphy Lynch"></p>
<h2 id="the-need"><a href="#the-need" class="headerlink" title="the need"></a>the need</h2><p>I a SharePoint tool to report critical incidents that occur in programs across the agency. A critical incident happens, a user fills out the InfoPath form, a SharePoint workflow routes the information to necessary parties and eveyone is informed as to what happened in a matter of minutes. That’s great, but when looking for trends across programs and within the programs themselves, we were relying on importing the information from the critical incident SharePoint list to Excel and doing the data analysis from there.</p>
<p>Every time someone wanted to analyze the data, they had to update the data, making the manipulations and make use of Excel’s graphing options.</p>
<p>Static, involved, and cumbersome.</p>
<p>At one point, we just embedded the Excel onto a SharePoint page:<br><img src="/images/highchartsSP/excelIncidents.PNG" alt="R1v3t1ng"></p>
<h2 id="the-implementation"><a href="#the-implementation" class="headerlink" title="the implementation"></a>the implementation</h2><p>The first step is to create a site page, and add a Content Editor. Within that editor edit the source and add the container for the graph:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"incident-container"</span>&gt;</span>No incidents to report.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>With the container in place, we’ll now want to query the SharePoint list, manipulate the data to pass to Highcharts, and then create the graph.</p>
<p>First step is to pass our page the necessary Highcharts packages and JQuery:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/Style%20Library/js/jquery-3.4.1.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.highcharts.com/highcharts.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.highcharts.com/highcharts-more.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.highcharts.com/modules/exporting.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://code.highcharts.com/modules/series-label.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>First I’m going to create some of the global arrays that I’ll need to pass between functions:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="keyword">var</span> splistitems;</span><br><span class="line"><span class="keyword">var</span> seriesarray = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">var</span> output = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">var</span> finalData = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Then I can go ahead and start the query to SharePoint, using SharePoint’s CAML query:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetChartData</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   seriesarray = [];</span><br><span class="line">   <span class="keyword">var</span> context = <span class="keyword">new</span> SP.ClientContext.get_current();</span><br><span class="line">   <span class="keyword">var</span> list = context.get_web().get_lists().getByTitle(<span class="string">"Incident Reporting"</span>);</span><br><span class="line">   <span class="keyword">var</span> view = list.get_views().getByTitle(<span class="string">"thisFiscalYear"</span>);</span><br><span class="line">   context.load(view);</span><br><span class="line"></span><br><span class="line">   context.executeQueryAsync(</span><br><span class="line">     <span class="function"><span class="keyword">function</span> (<span class="params">sender, args</span>)</span></span><br><span class="line"><span class="function">        </span>&#123; getItemsFromList(<span class="string">"Incident Reporting"</span>, <span class="string">"&lt;View&gt;&lt;Query&gt;"</span> + view.get_viewQuery() + <span class="string">"&lt;/Query&gt;&lt;/View&gt;"</span>) &#125;,</span><br><span class="line">     <span class="function"><span class="keyword">function</span> (<span class="params">sender, args</span>)</span></span><br><span class="line"><span class="function">        </span>&#123; alert(<span class="string">"error: "</span> + args.get_message()); &#125;</span><br><span class="line">   );</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The above gets the context of the query, finds my list and the associated view. (There’s a lot of incidents, going off the thisFiscalYear view, limits my query, to provide more recent data and faster rendering times, because I’m querying that specific view, which is filtering out incidents outside of this fiscal year.)</p>
<p>Now I can query the list, and then enumerate through the list items:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getItemsFromList</span>(<span class="params">listTitle, queryText</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> context = <span class="keyword">new</span> SP.ClientContext.get_current();</span><br><span class="line">  <span class="keyword">var</span> list = context.get_web().get_lists().getByTitle(listTitle);</span><br><span class="line">  <span class="keyword">var</span> query = <span class="keyword">new</span> SP.CamlQuery();</span><br><span class="line">  query.set_viewXml(queryText);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> items = list.getItems(query);</span><br><span class="line">  context.load(items);</span><br><span class="line"></span><br><span class="line">  context.executeQueryAsync(</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> listEnumerator = items.getEnumerator();</span><br><span class="line">      <span class="keyword">while</span> (listEnumerator.moveNext()) &#123;</span><br><span class="line">        <span class="keyword">var</span> currentlistitem = listEnumerator.get_current();</span><br><span class="line">        <span class="keyword">var</span> itemProgramName = currentlistitem.get_item(<span class="string">"SiteProgramName"</span>); <span class="comment">/*Use the internal column names  */</span></span><br><span class="line">        <span class="keyword">var</span> itemIncidentType = currentlistitem.get_item(<span class="string">"CriticalIncidentType"</span>);</span><br><span class="line">        <span class="keyword">var</span> seriesitem = &#123;</span><br><span class="line">                    name: itemProgramName,</span><br><span class="line">                    data: [ itemIncidentType ]</span><br><span class="line">                &#125;;</span><br><span class="line">                seriesarray.push(seriesitem);</span><br><span class="line">              &#125;</span><br></pre></td></tr></table></figure></p>
<p>At this point my <code>seriesarray</code> array looks something like this:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="attr">name</span>: programName, <span class="attr">data</span>: incident&#125;, &#123;<span class="attr">name</span>: programName, <span class="attr">data</span>: incident&#125;, &#123;<span class="attr">name</span>: programName2, <span class="attr">data</span>: incident&#125;]</span><br></pre></td></tr></table></figure></p>
<p>For each incident I have an object. That’s not very helpful. So I need to concatenate incidents from each program into one object. To this I’ll need a function:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatData</span> (<span class="params">arr, arrOut</span>) </span>&#123;</span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> existing = arrOut.filter(<span class="function"><span class="keyword">function</span>(<span class="params">v, i</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> v.name == item.name;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (existing.length) &#123;</span><br><span class="line">      <span class="keyword">var</span> existingIndex = arrOut.indexOf(existing[<span class="number">0</span>]);</span><br><span class="line">      arrOut[existingIndex].data = arrOut[existingIndex].data.concat(item.data);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> item.data == <span class="string">'string'</span>)</span><br><span class="line">        item.data = [item.data];</span><br><span class="line">      arrOut.push(item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Then:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">output = [];</span><br><span class="line">concatData(seriesarray, output);</span><br></pre></td></tr></table></figure></p>
<p>Now my <code>output</code> array has everything together, but I need to count the incidents of the same type in each program, so that I can graph it:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapper</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; input.length; i ++) &#123;</span><br><span class="line">    <span class="keyword">var</span> mapOutput = input[i].data.flat().reduce(<span class="function"><span class="keyword">function</span>(<span class="params">obj, b</span>) </span>&#123;</span><br><span class="line">      obj[b] = ++obj[b] || <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;, &#123;&#125;);</span><br><span class="line">    <span class="keyword">var</span> secondOutput = [];</span><br><span class="line">    <span class="keyword">var</span> totalIncidents = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> mapOutput) &#123;</span><br><span class="line">      <span class="keyword">var</span> seriesitem = &#123;</span><br><span class="line">                        name: prop,</span><br><span class="line">                        value: mapOutput[prop]</span><br><span class="line">                    &#125;;</span><br><span class="line">      secondOutput.push(seriesitem);</span><br><span class="line">      totalIncidents = totalIncidents + mapOutput[prop];</span><br><span class="line">      totalAllPro = totalAllPro + mapOutput[prop];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> seriesItem = &#123;</span><br><span class="line">      name: input[i].name + <span class="string">' &lt;b&gt;'</span> + totalIncidents + <span class="string">'&lt;/b&gt;'</span>,</span><br><span class="line">      <span class="comment">// total: totalIncidents,</span></span><br><span class="line">      data: secondOutput</span><br><span class="line">    &#125;</span><br><span class="line">    finalData.push(seriesItem);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>So one more time I have a function to better clean the data to accumulate same incidents in a program with the <code>reduce</code> function and also get the total number of incidents in each program.</p>
<p>Now the <code>finalData</code> array is looking like what Highcharts is expecting. To complete the <code>getItemsFromList</code> function from above:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mapper(output);</span><br><span class="line">              DrawChart(<span class="string">'bubble-container'</span>, finalData);</span><br><span class="line">            &#125;,</span><br><span class="line">      );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Now we come to DrawChart:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DrawChart</span>(<span class="params">render, data</span>) </span>&#123;</span><br><span class="line">        housingChart = <span class="keyword">new</span> Highcharts.Chart(&#123;</span><br><span class="line">            chart: &#123;</span><br><span class="line">                renderTo: render,</span><br><span class="line">                type: <span class="string">'packedbubble'</span>,</span><br><span class="line">                height: <span class="string">'100%'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            title: &#123;</span><br><span class="line">                text: <span class="string">'Incidents by Program'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            subtitle:&#123;</span><br><span class="line">                text: <span class="string">'Data as of July 1, 2019: '</span> + totalAllPro.toString() + <span class="string">' total incidents'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// colors: ['#DF5353', '#aaeeee', '#ff0066', '#eeaaee', '#DDDF0D', '#55BF3B', '#DF5353', '#7798BF', '#aaeeee', '#ff0066', '#eeaaee', '#DDDF0D', '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'],</span></span><br><span class="line">            tooltip: &#123;</span><br><span class="line">                useHTML: <span class="literal">true</span>,</span><br><span class="line">                pointFormat: <span class="string">'&lt;b&gt;&#123;point.name&#125;:&lt;/b&gt; &#123;point.value&#125;'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            plotOptions: &#123;</span><br><span class="line">              series: &#123;</span><br><span class="line">                animation: <span class="literal">false</span></span><br><span class="line">              &#125;,</span><br><span class="line">              packedbubble: &#123;</span><br><span class="line">                  boostThreshold: <span class="number">1</span>,</span><br><span class="line">                  draggable: <span class="literal">false</span>,</span><br><span class="line">                  minSize: <span class="string">'1%'</span>,</span><br><span class="line">                  maxSize: <span class="string">'100%'</span>,</span><br><span class="line">                  zMin: <span class="number">0</span>,</span><br><span class="line">                  zMax: <span class="number">50</span>,</span><br><span class="line">                  layoutAlgorithm: &#123;</span><br><span class="line">                      initialPositionRadius: <span class="number">100</span>,</span><br><span class="line">                      gravitationalConstant: <span class="number">0.1</span>,</span><br><span class="line">                      splitSeries: <span class="literal">true</span>,</span><br><span class="line">                      seriesInteraction: <span class="literal">false</span>,</span><br><span class="line">                      dragBetweenSeries: <span class="literal">false</span>,</span><br><span class="line">                      parentNodeLimit: <span class="literal">true</span>,</span><br><span class="line">                      parentNodeOptions: &#123;</span><br><span class="line">                          bubblePadding: <span class="number">30</span></span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  dataLabels: &#123;</span><br><span class="line">                      enabled: <span class="literal">true</span>,</span><br><span class="line">                      parentNodeFormat: <span class="string">'&#123;point.series.name&#125;'</span>,</span><br><span class="line">                      formatter: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="keyword">this</span>.y &gt; <span class="number">10</span>) &#123;</span><br><span class="line">                          <span class="keyword">return</span> <span class="keyword">this</span>.point.name;</span><br><span class="line">                        &#125;</span><br><span class="line">                      &#125;,</span><br><span class="line">                      style: &#123;</span><br><span class="line">                          color: <span class="string">'black'</span>,</span><br><span class="line">                          textOutline: <span class="string">'none'</span>,</span><br><span class="line">                          fontWeight: <span class="string">'normal'</span></span><br><span class="line">                          &#125;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            series: finalData</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>As you can see, I’m passing where I want to render the graph and also the data to the JSON that Highcharts is looking for.</p>
<h2 id="the-end-result"><a href="#the-end-result" class="headerlink" title="the end result"></a>the end result</h2><p><img src="/images/highchartsSP/fiscalGif.gif" alt="Bubble GIF"></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#the-need"><span class="toc-number">1.</span> <span class="toc-text">the need</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-implementation"><span class="toc-number">2.</span> <span class="toc-text">the implementation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-end-result"><span class="toc-number">3.</span> <span class="toc-text">the end result</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://rooksblog.com/2019/11/15/List/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://rooksblog.com/2019/11/15/List/&text=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rooksblog.com/2019/11/15/List/&is_video=false&description=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Connecting a Highcharts Graph to a SharePoint List&body=Check out this article: http://rooksblog.com/2019/11/15/List/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://rooksblog.com/2019/11/15/List/&title=Connecting a Highcharts Graph to a SharePoint List"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://rooksblog.com/2019/11/15/List/&name=Connecting a Highcharts Graph to a SharePoint List&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Austin Rooks
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects/">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


